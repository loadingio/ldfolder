// Generated by LiveScript 1.6.0
(function(){
  var ldfolder;
  ldfolder = function(opt){
    var root, this$ = this;
    root = opt.root;
    this.exclusive = opt.exclusive || false;
    this.root = root = typeof root === 'string'
      ? document.querySelector(root)
      : root ? root : null;
    this.root.addEventListener('click', function(e){
      var n, p;
      n = e.target;
      while (n && n !== this$.root && (!n.matches || (n.matches && !n.matches('.ldfd-toggle')))) {
        n = n.parentNode;
      }
      if (!(n && n !== this$.root)) {
        return;
      }
      p = n;
      while (p = p.nextSibling) {
        if (p.classList && p.classList.contains('ldfd-menu')) {
          break;
        }
      }
      if (p) {
        return this$.toggle(p);
      }
    });
    return this;
  };
  ldfolder.prototype = import$(Object.create(Object.prototype), {
    fit: function(menu){
      return this.toggle(menu, menu.parentNode.classList.contains('show'), true);
    },
    toggle: function(menu, v, force, internal, delta){
      var ison, ch, sh, n, this$ = this;
      force == null && (force = false);
      internal == null && (internal = false);
      ison = menu.parentNode.classList.contains('show');
      if ((v = v != null
        ? v
        : !ison) === ison && !force) {
        return;
      }
      if (this.exclusive && v && !internal) {
        Array.from(this.root.querySelectorAll('.ldfd.show > .ldfd-menu')).map(function(it){
          if (it.contains(menu) || menu.contains(it)) {
            return;
          }
          return this$.toggle(it, false, false, true);
        });
      }
      ch = getComputedStyle(menu).height || 0;
      menu.style.height = "";
      menu.offsetHeight;
      sh = menu.scrollHeight + (delta != null ? delta : 0);
      menu.style.height = ch;
      menu.offsetHeight;
      menu.style.height = (!v ? 0 : sh) + "px";
      menu.parentNode.classList.toggle('show', v);
      n = menu;
      while (n.parentNode && n.parentNode !== this.root) {
        n = n.parentNode;
        if (!n.matches('.ldfd-menu')) {
          continue;
        }
        this.toggle(n, v, true, true, (!v ? 0 : sh) - +ch.replace('px', ''));
        break;
      }
      return v;
    }
  });
  if (typeof module != 'undefined' && module !== null) {
    module.exports = ldfolder;
  } else {
    window.ldfolder = ldfolder;
  }
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);
